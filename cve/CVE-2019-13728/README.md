
<b>VULNERABILITY DETAILS</b>
From https://cs.chromium.org/chromium/src/v8/src/compiler/js-call-reducer.cc?l=7055&rcl=4636c1f0b8ea41d3d8dfe415f16f1022dd194545

ReduceRegExpPrototypeTest don't check that the receiver's map is equal to the native context's initial regexp map, so any regexp with untouched 'exec' method will pass the check.

JS call 'RegExpPrototypeTest' will be lowered to 'RegExpTest', and it will be further lowered to a callable node which calls Builtins::kRegExpPrototypeTestFast. (https://cs.chromium.org/chromium/src/v8/src/compiler/js-generic-lowering.cc?l=472&rcl=4636c1f0b8ea41d3d8dfe415f16f1022dd194545)

RegExpPrototypeTestFast assumes that the regexp has initial map and read/write lastIndex field directly with specific offset, and thus cause OOB write.

This bug should affect the current stable version of Chrome.


<b>VERSION</b>
Chrome Version: 78.0.3904.97 Stable (Official Build) (64-bit) 


<b>REPRODUCTION CASE</b>
Put the two poc files in the same directory.

d8 --allow-natives-syntax --expose-gc poc.js

What does poc file do:
1. Allocate some regexp, shrink the instance size by removing lastIndex from in-object property to ProperyArray.

2. Trigger GC to move regexp(s) to oldspace, expecting one of them lies at the bottom of a page.

3. When the jited code tries to access lastIndex field of regexp, it will crash due to access violation.

I only tested the poc on debug build d8 7.9.265 Linux x64, crash may not happen if you run the poc on other version of d8 because of the uncertainty behavior of GC process.
