<b>VULNERABILITY DETAILS</b>:
The attached oob.html file uses a JIT vulnerability in v8 to trigger a type confusion and change the length of an array. This leads to out of bounds read and write, which can be turned into a full renderer exploit.

The attached files apply to Chrome 81 and V8 8.1.307. Related code was changed so it doesn't trigger on Canary. Although the buggy code still remains.

Our understanding of the bug:
In src/compiler/dead-code-eliminiation.cc in ReduceDeoptimizeOrReturnOrTerminateOrTailCall, it will replace Terminate with Throw.
That replacement seems to be invalid as it can result in multiple control nodes attached to the same node in the effect-control-linearization phase. This can be seen in the minimized poc which triggers the following debug check.

# Fatal error in ../../v8/src/compiler/schedule.cc, line 297
# Debug check failed: BasicBlock::kNone == block->control() (none vs. throw).

This bug leads to an interesting primitive where instructions will be scheduled incorrectly. In the attached exploit we use this primitive to place a CheckMaps after arg1.val = -1.
This will let us write -1 over an array length, as the write will occur before the CheckMaps.

The attached poc changes an array length to be -1 and uses that to read and write out of bounds, demonstrating exploitability.


   CREDIT INFORMATION
   Reporter credit: Chris Salls and Jake Corina of Seaside Security, Chani Jindal of Shellphish
